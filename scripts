local player = game.Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local MarketplaceService = game:GetService("MarketplaceService")
local StarterGui = game:GetService("StarterGui")
local RunService = game:GetService("RunService")
local TeleportService = game:GetService("TeleportService")

local GAMEPASS_ID = 1296972626 -- WAŻNE: Upewnij się, że to jest POPRAWNE ID Twojego Game Passa!
local MM2_EXPERIENCE_ID = 142823291 -- WAŻNE: Upewnij się, że to jest POPRAWNE ID gry Murder Mystery 2!
local TELEPORT_PLACE_ID = 6557073879 -- Id gry, do której teleportuje (nieużywane do blokowania dostępu, tylko opcja)

local hasGamePass = false
local initialGamePassCheckDone = false -- Kontrola dla pierwszego powiadomienia o Game Passie
local isMainFrameVisible = true -- Śledzi widoczność MainFrame

local function sendNotification(title, text)
    local success, err = pcall(function()
        StarterGui:SetCore("SendNotification", {
            Title = title,
            Text = text,
            Icon = "rbxassetid://102860171689689",
            Duration = 5
        })
    end)
    if not success then
        warn("Nie udało się wysłać powiadomienia:", err)
    end
end

-- --- Tworzenie GUI ---

-- ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "UniversalScriptsGUI"
ScreenGui.Parent = player:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Enabled = true

-- MainFrame (główne okno GUI)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.Size = UDim2.new(0.5, 0, 0.6, 0) -- Proporcjonalny rozmiar (50% szerokości, 60% wysokości ekranu)
MainFrame.Position = UDim2.new(0.25, 0, 0.2, 0) -- Wyśrodkowanie na ekranie
MainFrame.BackgroundColor3 = Color3.fromRGB(44, 44, 44)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Visible = true

local MainFrameCorner = Instance.new("UICorner")
MainFrameCorner.CornerRadius = UDim.new(0, 10) -- Większe zaokrąglenie
MainFrameCorner.Parent = MainFrame

-- UIGridLayout dla MainFrame, aby ułożyć TitleLabel, TabsFrame i ContentFrame
-- Zapewnia kontrolę nad kolumnami i wierszami
local MainFrameGridLayout = Instance.new("UIGridLayout")
MainFrameGridLayout.Parent = MainFrame
MainFrameGridLayout.FillDirection = Enum.FillDirection.Horizontal -- Układ poziomy dla kolumn
MainFrameGridLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
MainFrameGridLayout.VerticalAlignment = Enum.VerticalAlignment.Top
MainFrameGridLayout.CellSize = UDim2.new(0.25, 0, 1, 0) -- Domylślny rozmiar komórek, zmienimy go dynamicznie
MainFrameGridLayout.StartCorner = Enum.StartCorner.TopLeft
MainFrameGridLayout.SortOrder = Enum.SortOrder.LayoutOrder
MainFrameGridLayout.Padding = UDim.new(0, 0) -- Brak odstępów między głównymi elementami

-- TitleLabel
local TitleLabel = Instance.new("TextLabel")
TitleLabel.Name = "TitleLabel"
TitleLabel.Parent = MainFrame
TitleLabel.Size = UDim2.new(1, 0, 0.12, 0) -- Będzie rozciągać się na całą szerokość MainFrame (ustawione przez GridLayout)
TitleLabel.BackgroundTransparency = 0
TitleLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
TitleLabel.Text = "UNIVERSAL SCRIPTS"
TitleLabel.Font = Enum.Font.LuckiestGuy
TitleLabel.TextColor3 = Color3.new(1, 1, 1)
TitleLabel.TextScaled = true
TitleLabel.BorderSizePixel = 0
TitleLabel.LayoutOrder = 1 -- Pierwszy element w layoucie

local TitleLabelCorner = Instance.new("UICorner")
TitleLabelCorner.CornerRadius = UDim.new(0, 10) -- Zaokrąglenie dla paska tytułowego
TitleLabelCorner.Parent = TitleLabel

-- TabsFrame (ramka na przyciski zakładek)
local TabsFrame = Instance.new("Frame")
TabsFrame.Name = "TabsFrame"
TabsFrame.Parent = MainFrame
TabsFrame.Size = UDim2.new(0.25, 0, 0.88, 0) -- 25% szerokości MainFrame, 88% wysokości MainFrame
TabsFrame.BackgroundColor3 = Color3.fromRGB(36, 36, 36)
TabsFrame.BorderSizePixel = 0
TabsFrame.Active = true
TabsFrame.LayoutOrder = 2 -- Drugi element w layoucie

local TabsFrameCorner = Instance.new("UICorner")
TabsFrameCorner.CornerRadius = UDim.new(0, 10) -- Zaokrąglenie
TabsFrameCorner.Parent = TabsFrame

-- Layout dla przycisków zakładek w TabsFrame
local TabsLayout = Instance.new("UIListLayout")
TabsLayout.Parent = TabsFrame
TabsLayout.FillDirection = Enum.FillDirection.Vertical
TabsLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
TabsLayout.Padding = UDim.new(0.02, 0) -- 2% odstępu między przyciskami
TabsLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- HomeTabButton
local HomeTabButton = Instance.new("TextButton")
HomeTabButton.Name = "HomeTabButton"
HomeTabButton.Parent = TabsFrame
HomeTabButton.Size = UDim2.new(0.9, 0, 0.1, 0) -- 90% szerokości TabsFrame, 10% wysokości elementu w TabsLayout
HomeTabButton.Text = "Home"
HomeTabButton.Font = Enum.Font.SourceSans
HomeTabButton.TextScaled = true
HomeTabButton.TextColor3 = Color3.new(0, 0, 0)
HomeTabButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70) -- Domyślnie podświetlony
HomeTabButton.BorderSizePixel = 0
HomeTabButton.LayoutOrder = 1
Instance.new("UICorner", HomeTabButton).CornerRadius = UDim.new(0, 5)

-- PremiumTabButton
local PremiumTabButton = Instance.new("TextButton")
PremiumTabButton.Name = "PremiumTabButton"
PremiumTabButton.Parent = TabsFrame
PremiumTabButton.Size = UDim2.new(0.9, 0, 0.1, 0)
PremiumTabButton.Text = "Premium"
PremiumTabButton.Font = Enum.Font.SourceSans
PremiumTabButton.TextScaled = true
PremiumTabButton.TextColor3 = Color3.new(0, 0, 0)
PremiumTabButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50) -- Domyślnie mniej podświetlony
PremiumTabButton.BorderSizePixel = 0
PremiumTabButton.LayoutOrder = 2
Instance.new("UICorner", PremiumTabButton).CornerRadius = UDim.new(0, 5)

-- ContentFrame (ramka na zawartość zakładek)
local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = MainFrame
ContentFrame.Size = UDim2.new(0.75, 0, 0.88, 0) -- 75% szerokości MainFrame, 88% wysokości MainFrame
ContentFrame.BackgroundColor3 = Color3.fromRGB(59, 59, 59)
ContentFrame.BorderSizePixel = 0
ContentFrame.Active = true
ContentFrame.LayoutOrder = 3 -- Trzeci element w layoucie
Instance.new("UICorner", ContentFrame).CornerRadius = UDim.new(0, 10) -- Większe zaokrąglenie

-- ScrollingFrame dla Home
local ScrollingFrameHome = Instance.new("ScrollingFrame")
ScrollingFrameHome.Name = "ScrollingFrameHome"
ScrollingFrameHome.Parent = ContentFrame
ScrollingFrameHome.Size = UDim2.new(1, 0, 1, 0) -- Wypełnia ContentFrame
ScrollingFrameHome.BackgroundColor3 = Color3.fromRGB(59, 59, 59)
ScrollingFrameHome.BorderSizePixel = 0
ScrollingFrameHome.ScrollingDirection = Enum.ScrollingDirection.Y
ScrollingFrameHome.Active = true
ScrollingFrameHome.Visible = true -- Domyślnie widoczny
Instance.new("UICorner", ScrollingFrameHome).CornerRadius = UDim.new(0, 8) -- Zaokrąglenie dla scrollingu

local HomeGridLayout = Instance.new("UIGridLayout")
HomeGridLayout.Parent = ScrollingFrameHome
HomeGridLayout.StartCorner = Enum.StartCorner.TopLeft
HomeGridLayout.FillDirection = Enum.FillDirection.Horizontal
HomeGridLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
HomeGridLayout.VerticalAlignment = Enum.VerticalAlignment.Top
HomeGridLayout.CellSize = UDim2.new(0.3, 0, 0.15, 0)
HomeGridLayout.CellPadding = UDim2.new(0.05, 0, 0.05, 0)

-- Przyciski dla Home (dodaj więcej, jeśli potrzebujesz)
local SpeedToolbutton = Instance.new("TextButton")
SpeedToolbutton.Name = "Speed Tool"
SpeedToolbutton.Parent = ScrollingFrameHome
SpeedToolbutton.Size = UDim2.new(1, 0, 1, 0) -- Wypełnia komórkę layoutu
SpeedToolbutton.Text = "Speed Tool"
SpeedToolbutton.Font = Enum.Font.SourceSans
SpeedToolbutton.TextScaled = true
SpeedToolbutton.TextColor3 = Color3.new(0, 0, 0)
SpeedToolbutton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
SpeedToolbutton.BorderSizePixel = 0
Instance.new("UICorner", SpeedToolbutton).CornerRadius = UDim.new(0, 5)
Instance.new("UITextSizeConstraint", SpeedToolbutton).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", SpeedToolbutton).AspectRatio = 3.9210526943206787

local ClicktptoolButton = Instance.new("TextButton")
ClicktptoolButton.Name = "Click tp tool"
ClicktptoolButton.Parent = ScrollingFrameHome
ClicktptoolButton.Size = UDim2.new(1, 0, 1, 0)
ClicktptoolButton.Text = "Click tp tool"
ClicktptoolButton.Font = Enum.Font.SourceSans
ClicktptoolButton.TextScaled = true
ClicktptoolButton.TextColor3 = Color3.new(0, 0, 0)
ClicktptoolButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
ClicktptoolButton.BorderSizePixel = 0
Instance.new("UICorner", ClicktptoolButton).CornerRadius = UDim.new(0, 5)
Instance.new("UITextSizeConstraint", ClicktptoolButton).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", ClicktptoolButton).AspectRatio = 3.9210526943206787

local SpectateButton_Home = Instance.new("TextButton")
SpectateButton_Home.Name = "Spectate (Home)"
SpectateButton_Home.Parent = ScrollingFrameHome
SpectateButton_Home.Size = UDim2.new(1, 0, 1, 0)
SpectateButton_Home.Text = "Spectate"
SpectateButton_Home.Font = Enum.Font.SourceSans
SpectateButton_Home.TextScaled = true
SpectateButton_Home.TextColor3 = Color3.new(0, 0, 0)
SpectateButton_Home.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
SpectateButton_Home.BorderSizePixel = 0
Instance.new("UICorner", SpectateButton_Home).CornerRadius = UDim.new(0, 5)
Instance.new("UITextSizeConstraint", SpectateButton_Home).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", SpectateButton_Home).AspectRatio = 3.9210526943206787

local NoclipButton = Instance.new("TextButton")
NoclipButton.Name = "Noclip"
NoclipButton.Parent = ScrollingFrameHome
NoclipButton.Size = UDim2.new(1, 0, 1, 0)
NoclipButton.Text = "Noclip"
NoclipButton.Font = Enum.Font.SourceSans
NoclipButton.TextScaled = true
NoclipButton.TextColor3 = Color3.new(0, 0, 0)
NoclipButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
NoclipButton.BorderSizePixel = 0
Instance.new("UICorner", NoclipButton).CornerRadius = UDim.new(0, 5)
Instance.new("UITextSizeConstraint", NoclipButton).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", NoclipButton).AspectRatio = 3.9210526943206787

local FlingButton = Instance.new("TextButton")
FlingButton.Name = "Fling"
FlingButton.Parent = ScrollingFrameHome
FlingButton.Size = UDim2.new(1, 0, 1, 0)
FlingButton.Text = "Fling"
FlingButton.Font = Enum.Font.SourceSans
FlingButton.TextScaled = true
FlingButton.TextColor3 = Color3.new(0, 0, 0)
FlingButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
FlingButton.BorderSizePixel = 0
Instance.new("UICorner", FlingButton).CornerRadius = UDim.new(0, 5)
Instance.new("UITextSizeConstraint", FlingButton).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", FlingButton).AspectRatio = 3.9210526943206787


-- ScrollingFrame dla Premium
local ScrollingFramePremium = Instance.new("ScrollingFrame")
ScrollingFramePremium.Name = "ScrollingFramePremium"
ScrollingFramePremium.Parent = ContentFrame
ScrollingFramePremium.Size = UDim2.new(1, 0, 1, 0) -- Wypełnia ContentFrame
ScrollingFramePremium.BackgroundColor3 = Color3.fromRGB(59, 59, 59)
ScrollingFramePremium.BorderSizePixel = 0
ScrollingFramePremium.ScrollingDirection = Enum.ScrollingDirection.Y
ScrollingFramePremium.Active = true
ScrollingFramePremium.Visible = false -- Domyślnie niewidoczny
Instance.new("UICorner", ScrollingFramePremium).CornerRadius = UDim.new(0, 8) -- Zaokrąglenie dla scrollingu

local PremiumGridLayout = Instance.new("UIGridLayout")
PremiumGridLayout.Parent = ScrollingFramePremium
PremiumGridLayout.StartCorner = Enum.StartCorner.TopLeft
PremiumGridLayout.FillDirection = Enum.FillDirection.Horizontal
PremiumGridLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
PremiumGridLayout.VerticalAlignment = Enum.VerticalAlignment.Top
PremiumGridLayout.CellSize = UDim2.new(0.3, 0, 0.15, 0)
PremiumGridLayout.CellPadding = UDim.new(0.05, 0, 0.05, 0)

-- Przyciski dla Premium
local SpectateButton_Premium = Instance.new("TextButton")
SpectateButton_Premium.Name = "Spectate (Premium)"
SpectateButton_Premium.Parent = ScrollingFramePremium
SpectateButton_Premium.Size = UDim2.new(1, 0, 1, 0)
SpectateButton_Premium.Text = "Spectate"
SpectateButton_Premium.Font = Enum.Font.SourceSans
SpectateButton_Premium.TextScaled = true
SpectateButton_Premium.TextColor3 = Color3.new(0, 0, 0)
SpectateButton_Premium.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
SpectateButton_Premium.BorderSizePixel = 0
Instance.new("UICorner", SpectateButton_Premium).CornerRadius = UDim.new(0, 5)
Instance.new("UITextSizeConstraint", SpectateButton_Premium).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", SpectateButton_Premium).AspectRatio = 3.9210526943206787

local MM2Button = Instance.new("TextButton")
MM2Button.Name = "MM2"
MM2Button.Parent = ScrollingFramePremium
MM2Button.Size = UDim2.new(1, 0, 1, 0)
MM2Button.Text = "MM2"
MM2Button.Font = Enum.Font.SourceSans
MM2Button.TextScaled = true
MM2Button.TextColor3 = Color3.new(0, 0, 0)
MM2Button.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
MM2Button.BorderSizePixel = 0
MM2Button.Visible = false -- Będzie widoczny tylko w MM2
Instance.new("UICorner", MM2Button).CornerRadius = UDim.new(0, 5)
Instance.new("UITextSizeConstraint", MM2Button).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", MM2Button).AspectRatio = 3.9210526943206787

local FlyButton = Instance.new("TextButton")
FlyButton.Name = "Console"
FlyButton.Parent = ScrollingFramePremium
FlyButton.Size = UDim2.new(1, 0, 1, 0)
FlyButton.Text = "Console"
FlyButton.Font = Enum.Font.SourceSans
FlyButton.TextScaled = true
FlyButton.TextColor3 = Color3.new(0, 0, 0)
FlyButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
FlyButton.BorderSizePixel = 0
Instance.new("UICorner", FlyButton).CornerRadius = UDim.new(0, 5)
Instance.new("UITextSizeConstraint", FlyButton).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", FlyButton).AspectRatio = 3.9210526943206787

local Invisibiltybutton = Instance.new("TextButton")
Invisibiltybutton.Name = "Invisibilty"
Invisibiltybutton.Parent = ScrollingFramePremium
Invisibiltybutton.Size = UDim2.new(1, 0, 1, 0)
Invisibiltybutton.Text = "Invisibilty"
Invisibiltybutton.Font = Enum.Font.SourceSans
Invisibiltybutton.TextScaled = true
Invisibiltybutton.TextColor3 = Color3.new(0, 0, 0)
Invisibiltybutton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
Invisibiltybutton.BorderSizePixel = 0
Instance.new("UICorner", Invisibiltybutton).CornerRadius = UDim.new(0, 5)
Instance.new("UITextSizeConstraint", Invisibiltybutton).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", Invisibiltybutton).AspectRatio = 3.9210526943206787

local GhostMM2Button = Instance.new("TextButton")
GhostMM2Button.Name = "GhostMM2"
GhostMM2Button.Parent = ScrollingFramePremium
GhostMM2Button.Size = UDim2.new(1, 0, 1, 0)
GhostMM2Button.Text = "GhostMM2"
GhostMM2Button.Font = Enum.Font.SourceSans
GhostMM2Button.TextScaled = true
GhostMM2Button.TextColor3 = Color3.new(0, 0, 0)
GhostMM2Button.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
GhostMM2Button.BorderSizePixel = 0
GhostMM2Button.Visible = false -- Będzie widoczny tylko w MM2
Instance.new("UICorner", GhostMM2Button).CornerRadius = UDim.new(0, 5)
Instance.new("UITextSizeConstraint", GhostMM2Button).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", GhostMM2Button).AspectRatio = 3.9210526943206787

local AdminPanelButton = Instance.new("TextButton")
AdminPanelButton.Name = "Admin Panel"
AdminPanelButton.Parent = ScrollingFramePremium
AdminPanelButton.Size = UDim2.new(1, 0, 1, 0)
AdminPanelButton.Text = "Admin Panel"
AdminPanelButton.Font = Enum.Font.SourceSans
AdminPanelButton.TextScaled = true
AdminPanelButton.TextColor3 = Color3.new(0, 0, 0)
AdminPanelButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
AdminPanelButton.BorderSizePixel = 0
Instance.new("UICorner", AdminPanelButton).CornerRadius = UDim.new(0, 5)
Instance.new("UITextSizeConstraint", AdminPanelButton).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", AdminPanelButton).AspectRatio = 3.9210526943206787


-- HideButton (przycisk do ukrywania/pokazywania GUI)
local HideButton = Instance.new("ImageButton")
HideButton.Name = "HideButton"
HideButton.Parent = ScreenGui
HideButton.Size = UDim2.new(0, 30, 0, 30) -- Stały rozmiar 30x30 pikseli
HideButton.BackgroundColor3 = Color3.fromRGB(200, 0, 0) -- Czerwony
HideButton.Image = "rbxassetid://102860171689689" -- Ikona krzyżyka lub inna
HideButton.ImageColor3 = Color3.new(1, 1, 1)
HideButton.ScaleType = Enum.ScaleType.Fit
HideButton.BorderSizePixel = 3 -- Przywrócone obramowanie!
HideButton.BorderColor3 = Color3.fromRGB(0,0,0) -- Kolor obramowania
HideButton.ZIndex = 5
HideButton.Active = true
HideButton.Draggable = true
HideButton.Visible = false -- Domyślnie ukryty, pokaże się po ukryciu MainFrame

-- --- Funkcje i logika skryptu ---

local function showTab(tabName)
    ScrollingFrameHome.Visible = false
    ScrollingFramePremium.Visible = false

    -- Zresetuj kolory przycisków zakładek
    HomeTabButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    PremiumTabButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)

    if tabName == "Home" then
        ScrollingFrameHome.Visible = true
        HomeTabButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70) -- Podświetl aktywną zakładkę
    elseif tabName == "Premium" then
        -- Sprawdzanie Game Passa
        local success, result = pcall(function()
            return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
        end)

        if success then
            hasGamePass = result
            if hasGamePass then
                ScrollingFramePremium.Visible = true
                PremiumTabButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70) -- Podświetl aktywną zakładkę
                -- Powiadomienie tylko jeśli jeszcze nie było i Game Pass jest aktywny
                if not initialGamePassCheckDone then
                    sendNotification("Universal Scripts", "Wersja premium aktywowana.")
                    initialGamePassCheckDone = true -- Oznacz, że powiadomienie zostało wysłane
                end
            else
                sendNotification("Universal Scripts", "Musisz posiadać wersję premium, aby uzyskać dostęp do tej zakładki!")
                MarketplaceService:PromptGamePassPurchase(player, GAMEPASS_ID) -- Prośba o zakup
                -- Opcjonalnie: teleportuj gracza, jeśli nie ma Game Passa
                -- TeleportService:Teleport(TELEPORT_PLACE_ID, player)
            end
        else
            warn("Błąd podczas sprawdzania wersji premium (showTab):", result)
            sendNotification("Universal Scripts", "Nie można sprawdzić statusu wersji premium. Spróbuj ponownie.")
        end
    end
end

local function checkGamePassStatus()
    local success, result = pcall(function()
        return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
    end)

    if success then
        hasGamePass = result
        if not initialGamePassCheckDone then
            if hasGamePass then
                sendNotification("Universal Scripts", "Posiadasz wersję premium! Funkcje Premium odblokowane.")
            else
                sendNotification("Universal Scripts", "Nie posiadasz wersji premium. Kliknij zakładkę Premium, aby przejść do zakupu.")
            end
            initialGamePassCheckDone = true
        end
    else
        warn("Błąd podczas sprawdzania wersji premium (checkGamePassStatus):", result)
        sendNotification("Universal Scripts", "Nie można sprawdzić statusu wersji premium. Spróbuj ponownie.")
    end
end

local function updateMM2ButtonVisibility()
    if game.PlaceId == MM2_EXPERIENCE_ID then
        MM2Button.Visible = true
        GhostMM2Button.Visible = true
    else
        MM2Button.Visible = false
        GhostMM2Button.Visible = false
    end
end

local function updateHideButtonVisibilityAndPosition()
    if isMainFrameVisible then
        HideButton.Visible = false -- Ukryj HideButton, gdy MainFrame jest widoczny
    else
        HideButton.Visible = true -- Pokaż HideButton, gdy MainFrame jest ukryty
        -- Ustaw HideButton w stałym miejscu na ekranie, gdy MainFrame jest ukryty
        HideButton.Position = UDim2.new(1, -HideButton.Size.X.Offset - 10, 0, 10) -- 10px od prawej, 10px od góry
    end
end

-- Funkcja do ładowania i uruchamiania skryptów z URL
local function runScriptAndNotify(url, buttonName)
    local scriptContent = nil
    local successHttpGet, errHttpGet = pcall(function()
        scriptContent = game:HttpGet(url)
    end)

    if not successHttpGet then
        sendNotification("Universal Scripts", "Błąd pobierania skryptu '" .. buttonName .. "': " .. tostring(errHttpGet))
        warn("Błąd HTTP pobierania skryptu '" .. buttonName .. "':", errHttpGet)
        return
    end

    if not scriptContent or #scriptContent == 0 then
        sendNotification("Universal Scripts", "Pobrany skrypt '" .. buttonName .. "' jest pusty lub nieprawidłowy.")
        warn("Pobrany skrypt '" .. buttonName .. "' jest pusty.")
        return
    end

    local func, loadErr = loadstring(scriptContent)
    if not func then
        sendNotification("Universal Scripts", "Błąd parsowania skryptu '" .. buttonName .. "': " .. tostring(loadErr))
        warn("Błąd loadstring dla skryptu '" .. buttonName .. "':", loadErr)
        return
    end

    local successRun, runErr = pcall(func)
    if successRun then
        sendNotification("Universal Scripts", "Skrypt '" .. buttonName .. "' załadowany i uruchomiony!")
    else
        sendNotification("Universal Scripts", "Błąd uruchamiania skryptu '" .. buttonName .. "': " .. tostring(runErr))
        warn("Błąd wykonania skryptu '" .. buttonName .. "':", runErr)
    end
end

-- --- Podpięcie zdarzeń ---

-- Tab Button Click Events
HomeTabButton.MouseButton1Click:Connect(function()
    showTab("Home")
end)

PremiumTabButton.MouseButton1Click:Connect(function()
    showTab("Premium")
end)

-- Hide/Show GUI
HideButton.MouseButton1Click:Connect(function()
    isMainFrameVisible = not isMainFrameVisible
    MainFrame.Visible = isMainFrameVisible
    updateHideButtonVisibilityAndPosition()
end)

-- Event Listeners for Home Tab Buttons
SpeedToolbutton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/X7B0HPc2", SpeedToolbutton.Text)
end)

ClicktptoolButton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/4KF2WJ9u", ClicktptoolButton.Text)
end)

SpectateButton_Home.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/UFVLWQRw", SpectateButton_Home.Text)
end)

NoclipButton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/CnbYfaj1", NoclipButton.Text)
end)

FlingButton.MouseButton1Click:Connect(function()
    runScriptAndNotify('https://raw.githubusercontent.com/0Ben1/fe/main/obf_rf6iQURzu1fqrytcnLBAvW34C9N55kS9g9G3CKz086rC47M6632sEd4ZZYB0AYgV.lua.txt', FlingButton.Text)
end)

-- Event Listeners for Premium Tab Buttons (wraz ze sprawdzaniem GamePassa)
SpectateButton_Premium.MouseButton1Click:Connect(function()
    local success, currentHasGamePass = pcall(function()
        return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
    end)

    if success then
        if currentHasGamePass then
            runScriptAndNotify("https://pastebin.com/raw/UFVLWQRw", SpectateButton_Premium.Text)
        else
            sendNotification("Universal Scripts", "Musisz posiadać wersję premium, aby użyć tej funkcji!")
            MarketplaceService:PromptGamePassPurchase(player, GAMEPASS_ID)
        end
    else
        warn("Błąd podczas sprawdzania wersji premium (Spectate):", currentHasGamePass)
        sendNotification("Universal Scripts", "Wystąpił błąd podczas sprawdzania wersji premium.")
    end
end)

MM2Button.MouseButton1Click:Connect(function()
    local success, currentHasGamePass = pcall(function()
        return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
    end)

    if success then
        if currentHasGamePass then
            runScriptAndNotify("https://raw.githubusercontent.com/vertex-peak/vertex/refs/heads/main/loadstring", MM2Button.Text)
        else
            sendNotification("Universal Scripts", "Musisz posiadać wersję premium, aby użyć tej funkcji!")
            MarketplaceService:PromptGamePassPurchase(player, GAMEPASS_ID)
        end
    else
        warn("Błąd podczas sprawdzania wersji premium (MM2):", currentHasGamePass)
        sendNotification("Universal Scripts", "Wystąpił błąd podczas sprawdzania wersji premium.")
    end
end)

FlyButton.MouseButton1Click:Connect(function()
    local success, currentHasGamePass = pcall(function()
        return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
    end)

    if success then
        if currentHasGamePass then
            runScriptAndNotify("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source", FlyButton.Text)
        else
            sendNotification("Universal Scripts", "Musisz posiadać wersję premium, aby użyć tej funkcji!")
            MarketplaceService:PromptGamePassPurchase(player, GAMEPASS_ID)
        end
    else
        warn("Błąd podczas sprawdzania wersji premium (Console):", currentHasGamePass)
        sendNotification("Universal Scripts", "Wystąpił błąd podczas sprawdzania wersji premium.")
    end
end)

Invisibiltybutton.MouseButton1Click:Connect(function()
    local success, currentHasGamePass = pcall(function()
        return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
    end)

    if success then
        if currentHasGamePass then
            runScriptAndNotify('https://pastebin.com/raw/3Rnd9rHf', Invisibiltybutton.Text)
        else
            sendNotification("Universal Scripts", "Musisz posiadać wersję premium, aby użyć tej funkcji!")
            MarketplaceService:PromptGamePassPurchase(player, GAMEPASS_ID)
        end
    else
        warn("Błąd podczas sprawdzania wersji premium (Invisibilty):", currentHasGamePass)
        sendNotification("Universal Scripts", "Wystąpił błąd podczas sprawdzania wersji premium.")
    end
end)

GhostMM2Button.MouseButton1Click:Connect(function()
    local success, currentHasGamePass = pcall(function()
        return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
    end)

    if success then
        if currentHasGamePass then
            runScriptAndNotify("https://raw.githubusercontent.com/GhostPlayer352/Test4/main/Murder%20Mystery", GhostMM2Button.Text)
        else
            sendNotification("Universal Scripts", "Musisz posiadać wersję premium, aby użyć tej funkcji!")
            MarketplaceService:PromptGamePassPurchase(player, GAMEPASS_ID)
        end
    else
        warn("Błąd podczas sprawdzania wersji premium (GhostMM2):", currentHasGamePass)
        sendNotification("Universal Scripts", "Wystąpił błąd podczas sprawdzania wersji premium.")
    end
end)

AdminPanelButton.MouseButton1Click:Connect(function()
    local success, currentHasGamePass = pcall(function()
        return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
    end)

    if success then
        if currentHasGamePass then
            -- TUTAJ WSTAW PRAWIDŁOWY URL DO SKRYPTU ADMIN PANEL
            runScriptAndNotify("https://pastebin.com/raw/EXAMPLE_ADMIN_PANEL_URL", AdminPanelButton.Text) -- PAMIĘTAJ ABY ZMIENIĆ TEN URL!
        else
            sendNotification("Universal Scripts", "Musisz posiadać wersję premium, aby użyć tej funkcji!")
            MarketplaceService:PromptGamePassPurchase(player, GAMEPASS_ID)
        end
    else
        warn("Błąd podczas sprawdzania wersji premium (Admin Panel):", currentHasGamePass)
        sendNotification("Universal Scripts", "Wystąpił błąd podczas sprawdzania wersji premium.")
    end
end)

-- Zdarzenie zakupu Game Passa
MarketplaceService.PromptGamePassPurchaseFinished:Connect(function(userId, gamePassId, wasPurchased)
    if userId == player.UserId and gamePassId == GAMEPASS_ID then
        if wasPurchased then
            sendNotification("Universal Scripts", "Wersja premium kupiona pomyślnie! Dziękujemy za zakup.")
            hasGamePass = true
            showTab("Premium") -- Po zakupie przejdź na zakładkę Premium
        else
            sendNotification("Universal Scripts", "Anulowano zakup wersji premium.")
        end
    end
end)

-- --- Inicjalizacja skryptu ---
spawn(function()
    task.wait(1) -- Daj chwilę na załadowanie GUI
    
    -- Dostosowanie siatki MainFrame
    MainFrameGridLayout.CellSize = UDim2.new(1, 0, 0.12, 0) -- Rozmiar dla pierwszej komórki (TitleLabel)
    MainFrameGridLayout.CellSize = UDim2.new(0.25, 0, 0.88, 0) -- Rozmiar dla drugiej komórki (TabsFrame)
    MainFrameGridLayout.CellSize = UDim2.new(0.75, 0, 0.88, 0) -- Rozmiar dla trzeciej komórki (ContentFrame)

    checkGamePassStatus() -- Sprawdzamy Game Passa na start i wysyłamy pierwsze powiadomienie
    updateMM2ButtonVisibility() -- Aktualizujemy widoczność przycisków MM2 na start
    showTab("Home") -- Wyświetl zakładkę Home jako domyślną
    isMainFrameVisible = true -- Upewniamy się, że stan jest zgodny z widocznością MainFrame
    updateHideButtonVisibilityAndPosition() -- Ustaw początkową pozycję HideButton i jego widoczność
    sendNotification("Universal Scripts", "Witaj w Universal Scripts! Skrypt załadowany.")
end)

print("SKRYPT ZAKOŃCZYŁ INICJALIZACJĘ. Sprawdź okno Output (F9) pod kątem błędów.")
